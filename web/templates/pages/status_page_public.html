{{define "status_page_public.html"}}
<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="refresh" content="60">
    <title>{{.Page.Name}} — Status</title>
    <link rel="icon" href="/static/favicon.svg" type="image/svg+xml">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/lucide@0.469.0/dist/umd/lucide.min.js"></script>
    <link rel="stylesheet" href="/static/css/output.css">
</head>
<body class="bg-background text-foreground font-sans min-h-screen antialiased">

    <!-- Nav -->
    <nav class="border-b border-border bg-background/80 backdrop-blur-sm">
        <div class="max-w-3xl mx-auto px-4 sm:px-6 h-14 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <a href="/" class="flex items-center space-x-2.5">
                    <div class="w-7 h-7 bg-accent rounded-md flex items-center justify-center">
                        <i data-lucide="shield-check" class="w-3.5 h-3.5 text-white"></i>
                    </div>
                    <span class="text-sm font-semibold text-foreground">WatchDog</span>
                </a>
                <span class="px-1.5 py-0.5 text-[10px] font-semibold uppercase tracking-wider rounded bg-amber-500/15 text-amber-400 border border-amber-500/20">Beta</span>
            </div>
            <div class="flex items-center space-x-2">
                <a href="#subscribe" class="px-3 py-1.5 text-xs font-medium text-muted-foreground hover:text-foreground border border-border rounded-md transition-colors">
                    Subscribe
                </a>
                <a href="/register" class="px-3.5 py-1.5 bg-accent text-accent-foreground hover:bg-accent/90 text-xs font-medium rounded-md transition-colors">
                    Sign Up
                </a>
            </div>
        </div>
    </nav>

    <div class="max-w-3xl mx-auto px-4 sm:px-6 py-10 sm:py-14">

        <!-- Header -->
        <div class="text-center mb-10">
            <h1 class="text-2xl font-bold text-foreground tracking-tight">{{.Page.Name}}</h1>
            {{if .Page.Description}}
            <p class="text-sm text-muted-foreground mt-2 max-w-md mx-auto">{{.Page.Description}}</p>
            {{end}}
        </div>

        <!-- Overall Status Banner -->
        <div class="rounded-lg border p-5 mb-10 text-center
            {{if and .AllUp (gt (len .Monitors) 0)}}bg-emerald-500/[0.07] border-emerald-500/20
            {{else if gt (len .Monitors) 0}}bg-red-500/[0.07] border-red-500/20
            {{else}}bg-card border-border{{end}}">
            <div class="flex items-center justify-center space-x-2.5">
                {{if gt (len .Monitors) 0}}
                <div class="w-2 h-2 rounded-full animate-pulse-dot
                    {{if .AllUp}}bg-emerald-400{{else}}bg-red-400{{end}}"></div>
                {{end}}
                <span class="text-sm font-medium
                    {{if and .AllUp (gt (len .Monitors) 0)}}text-emerald-400
                    {{else if gt (len .Monitors) 0}}text-red-400
                    {{else}}text-muted-foreground{{end}}">
                    {{.OverallStatus}}
                </span>
            </div>
            {{if and (gt .AggregateUptime 0) (gt (len .Monitors) 0)}}
            <p class="text-xs text-muted-foreground mt-1.5">{{formatPercent .AggregateUptime}}% uptime over the last 90 days</p>
            {{end}}
        </div>

        <!-- Monitors -->
        {{if .Monitors}}
        <div class="bg-card border border-border rounded-lg overflow-hidden">
            {{range $i, $m := .Monitors}}
            <div class="{{if $i}}border-t border-border{{end}}">
                <div class="px-3 sm:px-5 py-3.5 flex items-center justify-between">
                    <div class="flex items-center space-x-2 sm:space-x-3 min-w-0">
                        <div class="w-2 h-2 rounded-full shrink-0
                            {{if eq .Status "up"}}bg-emerald-400
                            {{else if eq .Status "down"}}bg-red-400
                            {{else}}bg-zinc-500{{end}}"></div>
                        <span class="text-sm font-medium text-foreground truncate">{{.Name}}</span>
                        <span class="hidden sm:inline-flex px-1.5 py-0.5 text-[10px] font-medium uppercase tracking-wider rounded
                            {{if eq .Type "http"}}bg-blue-500/10 text-blue-400
                            {{else if eq .Type "tcp"}}bg-purple-500/10 text-purple-400
                            {{else if eq .Type "ping"}}bg-amber-500/10 text-amber-400
                            {{else if eq .Type "dns"}}bg-cyan-500/10 text-cyan-400
                            {{else if eq .Type "tls"}}bg-emerald-500/10 text-emerald-400
                            {{else}}bg-muted text-muted-foreground{{end}}">{{.Type}}</span>
                    </div>
                    <div class="flex items-center space-x-3 sm:space-x-4 shrink-0 ml-2 sm:ml-4">
                        {{if .HasLatency}}
                        <span class="text-xs text-muted-foreground tabular-nums">{{.LatencyMs}}ms</span>
                        {{end}}
                        {{if ge .UptimePercent 0.0}}
                        <span class="text-xs font-medium tabular-nums
                            {{if ge .UptimePercent 99.0}}text-emerald-400
                            {{else if ge .UptimePercent 95.0}}text-amber-400
                            {{else}}text-red-400{{end}}">{{formatPercent .UptimePercent}}%</span>
                        {{end}}
                        <span class="text-xs font-medium
                            {{if eq .Status "up"}}text-emerald-400
                            {{else if eq .Status "down"}}text-red-400
                            {{else}}text-muted-foreground{{end}}">
                            {{if eq .Status "up"}}Operational
                            {{else if eq .Status "down"}}Down
                            {{else}}Unknown{{end}}
                        </span>
                    </div>
                </div>
                {{if .UptimeHistory}}
                <div class="px-3 sm:px-5 pb-3">
                    <div class="flex items-end space-x-px">
                        {{range .UptimeHistory}}
                        <div class="flex-1 rounded-sm
                            {{if lt .Percent 0.0}}h-4 bg-muted/10 border border-dashed border-muted/20
                            {{else if ge .Percent 99.0}}h-8 bg-emerald-500/70
                            {{else if ge .Percent 50.0}}h-8 bg-amber-500/70
                            {{else}}h-8 bg-red-500/70{{end}}"
                            title="{{.Date}}: {{if lt .Percent 0.0}}No data{{else}}{{printf "%.0f" .Percent}}% uptime{{end}}"></div>
                        {{end}}
                    </div>
                    <div class="flex items-center justify-between mt-1.5">
                        {{if lt .DataDays 90}}
                        <span class="text-[9px] text-muted-foreground/50">Monitoring since {{.MonitoringSince.Format "Jan 2"}}</span>
                        {{else}}
                        <span class="text-[9px] text-muted-foreground/50">90 days ago</span>
                        {{end}}
                        <span class="text-[9px] text-muted-foreground/50">Today</span>
                    </div>
                </div>
                {{end}}
            </div>
            {{end}}
        </div>
        {{else}}
        <div class="bg-card border border-border rounded-lg p-10 text-center">
            <i data-lucide="activity" class="w-8 h-8 text-muted-foreground/30 mx-auto mb-3"></i>
            <p class="text-sm text-muted-foreground">No monitors configured for this status page.</p>
        </div>
        {{end}}

        <!-- Incident History -->
        <div class="mt-10">
            <h2 class="text-sm font-semibold text-foreground mb-4">Incident History</h2>
            {{if .Incidents}}
            <div class="bg-card border border-border rounded-lg overflow-hidden divide-y divide-border">
                {{range .Incidents}}
                <div class="px-3 sm:px-5 py-3.5 flex items-start sm:items-center justify-between gap-3">
                    <div class="min-w-0">
                        <div class="flex items-center space-x-2">
                            <span class="px-1.5 py-0.5 text-[10px] font-medium uppercase tracking-wider rounded
                                {{if eq .Status "open"}}bg-red-500/10 text-red-400
                                {{else if eq .Status "acknowledged"}}bg-amber-500/10 text-amber-400
                                {{else}}bg-emerald-500/10 text-emerald-400{{end}}">{{.Status}}</span>
                            <span class="text-sm font-medium text-foreground truncate">{{.MonitorName}}</span>
                        </div>
                        <p class="text-xs text-muted-foreground mt-1">
                            {{formatTimeAgo .StartedAt}}
                            {{if not .IsActive}} · Resolved in {{formatDuration .Duration}}{{end}}
                        </p>
                    </div>
                    {{if .IsActive}}
                    <div class="w-2 h-2 rounded-full bg-red-400 animate-pulse-dot shrink-0 mt-1.5 sm:mt-0"></div>
                    {{end}}
                </div>
                {{end}}
            </div>
            {{else}}
            <div class="bg-card border border-border rounded-lg p-8 text-center">
                <i data-lucide="check-circle-2" class="w-6 h-6 text-emerald-400/60 mx-auto mb-2"></i>
                <p class="text-sm text-muted-foreground">No incidents in the last 30 days.</p>
            </div>
            {{end}}
        </div>

        <!-- Subscribe Section -->
        <div id="subscribe" class="mt-10">
            <div class="bg-card border border-border rounded-lg p-6 text-center">
                <i data-lucide="bell" class="w-6 h-6 text-muted-foreground/40 mx-auto mb-2.5"></i>
                <h3 class="text-sm font-medium text-foreground mb-1">Subscribe to Updates</h3>
                <p class="text-xs text-muted-foreground mb-4">Get notified when something goes wrong.</p>
                <button disabled class="px-4 py-2 bg-muted/50 text-muted-foreground text-xs font-medium rounded-md cursor-not-allowed">
                    Coming Soon
                </button>
            </div>
        </div>

        <!-- Footer -->
        <div class="mt-12 pt-6 border-t border-border">
            <div class="flex flex-col sm:flex-row items-center justify-between gap-4 text-xs text-muted-foreground/50">
                <div class="flex items-center space-x-2">
                    <a href="/" class="inline-flex items-center space-x-1.5 hover:text-muted-foreground transition-colors">
                        <i data-lucide="shield-check" class="w-3 h-3"></i>
                        <span>Powered by WatchDog</span>
                    </a>
                    <span class="px-1 py-0.5 text-[9px] font-semibold uppercase tracking-wider rounded bg-amber-500/15 text-amber-400/70 border border-amber-500/10">Beta</span>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="https://github.com/sylvester-francis/watchdog" target="_blank" rel="noopener noreferrer" class="inline-flex items-center space-x-1 hover:text-muted-foreground transition-colors">
                        <i data-lucide="github" class="w-3 h-3"></i>
                        <span>GitHub</span>
                    </a>
                    <a href="/register" class="hover:text-muted-foreground transition-colors">Create your own status page</a>
                </div>
            </div>
        </div>
    </div>

    <script>lucide.createIcons();</script>
</body>
</html>
{{end}}
